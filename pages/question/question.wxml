<view class="page-container" wx:if="{{isInitialized}}">
  <!-- 进度条 -->
  <view class="progress-bar">
    <view class="progress-fill" style="width: {{progress}}%;"></view>
  </view>
  
  <!-- 题目计数 -->
  <view class="question-counter">
    <text class="counter-text">{{currentQuestion + 1}} / {{totalQuestions}}</text>
  </view>

  <!-- 当前题目 -->
  <view class="question-container" wx:if="{{questions[currentQuestion]}}">
    <view class="question-card">
      <view class="question-header">
        <text class="question-title">{{questions[currentQuestion].title}}</text>
        <text wx:if="{{questions[currentQuestion].required}}" class="required-tag">* 必填</text>
      </view>
      
      <!-- 选项列表 -->
      <view class="options-container">
        <!-- 单选 -->
        <radio-group wx:if="{{questions[currentQuestion].type === 'single'}}" 
                     class="radio-group"
                     bindchange="onOptionSelect">
          <view wx:for="{{questions[currentQuestion].options}}" 
                wx:key="value"
                wx:for-item="option"
                class="radio-wrapper">
            <label class="radio-label">
              <radio value="{{option.value}}" 
                     checked="{{isSingleSelected(option.value)}}" />
              <text class="option-label">{{option.label}}</text>
            </label>
          </view>
        </radio-group>
        
        <!-- 多选 -->
        <checkbox-group wx:if="{{questions[currentQuestion].type === 'multiple'}}" 
                        class="checkbox-group"
                        bindchange="onOptionToggle">
          <view wx:for="{{questions[currentQuestion].options}}" 
                wx:key="value"
                wx:for-item="option"
                class="checkbox-wrapper">
            <label class="checkbox-label">
              <checkbox value="{{option.value}}" 
                        checked="{{isMultiSelected(option.value)}}" />
              <text class="option-label">{{option.label}}</text>
            </label>
          </view>
        </checkbox-group>
      </view>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="action-bar">
    <button wx:if="{{currentQuestion > 0}}" 
            class="btn-secondary" 
            bindtap="goBack">
      上一题
    </button>

    <button class="btn-primary" bindtap="nextQuestion">
      <block wx:if="{{currentQuestion >= totalQuestions - 1}}">提交诊断</block>
      <block wx:else>下一题</block>
    </button>

  </view>
</view>

<!-- 加载状态 -->
<view wx:else class="loading-container">
  <text class="loading-text">正在加载问卷...</text>
</view>
