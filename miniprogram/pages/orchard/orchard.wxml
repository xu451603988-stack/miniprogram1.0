<view class="container">

<view class="status-card">
  <view class="card-bg-circle"></view>
  <view class="status-content">
    <view class="status-header">
      <view class="status-title-group">
        <text class="status-icon">ğŸ›¡ï¸</text>
        <text class="status-title">æ™ºèƒ½æ‰˜ç®¡æœåŠ¡</text>
      </view>
      <view class="status-badge {{hasLocation ? 'active' : ''}}">
        {{hasLocation ? 'è¿è¡Œä¸­' : 'å¾…é…ç½®'}}
      </view>
    </view>
    <text class="status-desc">
      {{hasLocation ? 'ç³»ç»Ÿæ­£åœ¨å®æ—¶ç›‘æµ‹æœå›­å¤©æ°”ä¸ç‰©å€™ï¼Œå‘ç°å¼‚å¸¸å°†è‡ªåŠ¨é¢„è­¦ã€‚' : 'è¯·å®Œå–„æœå›­ä½ç½®ä¸ä¿¡æ¯ï¼Œå¼€å¯æ‚¨çš„ä¸“å±æ™ºèƒ½å®ˆæŠ¤ã€‚'}}
    </text>
  </view>
</view>

<view class="section-card">
  <view class="card-title">æœå›­ä½ç½®</view>
  
  <view class="location-box" bindtap="chooseLocation">
    <view class="location-icon-wrap">
      <text class="location-icon">ğŸ“</text>
    </view>
    <view class="location-info">
      <text class="location-name {{orchard.name ? '' : 'placeholder'}}">{{orchard.name || 'ç‚¹å‡»é€‰æ‹©æœå›­ä½ç½®'}}</text>
      <text class="location-address">{{orchard.address || 'æˆ‘ä»¬éœ€è¦ç»çº¬åº¦æ¥è·å–ç²¾å‡†å¤©æ°”'}}</text>
    </view>
    <text class="arrow">â€º</text>
  </view>
</view>

<view class="section-card">
  <view class="card-title">ç§æ¤æ¡£æ¡ˆ</view>
  
  <picker bindchange="bindVarietyChange" value="{{varietyIndex}}" range="{{varieties}}">
    <view class="form-item">
      <text class="label">ä½œç‰©ä¸å“ç§</text>
      <view class="picker-value-group">
        <text class="picker-value">{{orchard.variety || 'è¯·é€‰æ‹©'}}</text>
        <text class="arrow">â€º</text>
      </view>
    </view>
  </picker>

  <view class="divider"></view>

  <view class="form-item">
    <text class="label">å¹³å‡æ ‘é¾„</text>
    <view class="input-wrap">
      <input class="input" type="number" placeholder="0" placeholder-class="input-placeholder"
             value="{{orchard.age}}" bindinput="bindAgeInput" />
      <text class="unit">å¹´</text>
    </view>
  </view>
</view>

<view class="section-card task-card" wx:if="{{currentTask && hasLocation}}">
  <view class="task-header">
    <view class="month-badge">
      <text class="month-num">{{currentMonth}}</text>
      <text class="month-text">æœˆå†œäº‹</text>
    </view>
    <text class="task-phenology">{{currentTask.phenology}}</text>
  </view>
  <view class="task-title">{{currentTask.title}}</view>
  
  <view class="task-section">
    <view class="sec-header">
      <text class="sec-icon">ğŸ› ï¸</text> é‡ç‚¹å·¥ä½œ
    </view>
    <view class="task-list">
      <view class="task-item" wx:for="{{currentTask.key_tasks}}" wx:key="*this">
        <text class="dot">â€¢</text> {{item}}
      </view>
    </view>
  </view>

  <view class="task-section">
    <view class="sec-header">
      <text class="sec-icon">ğŸŒ±</text> æ–½è‚¥æ–¹æ¡ˆ
    </view>
    <text class="sec-content">{{currentTask.fertilizer}}</text>
  </view>

  <view class="task-section last">
    <view class="sec-header">
      <text class="sec-icon">ğŸ›</text> æ¤ä¿æ‰“è¯
    </view>
    <text class="sec-content">{{currentTask.protection}}</text>
  </view>
</view>

<view class="footer">
  <button class="save-btn" hover-class="save-btn-hover" bindtap="saveOrchard">
    {{hasLocation ? 'æ›´æ–°æ‰˜ç®¡æ¡£æ¡ˆ' : 'ä¿å­˜å¹¶å¼€å¯æ‰˜ç®¡'}}
  </button>
</view>

</view>