<view class="container">
  
  <view class="header">
    <view class="avatar-wrapper">
      <open-data type="userAvatarUrl"></open-data>
    </view>
    <view class="info">
      <open-data type="userNickName" class="nickname"></open-data>
      <view class="badge {{isVip ? 'vip-badge' : 'normal-badge'}}">
        <text wx:if="{{isVip}}" style="margin-right: 6rpx;">👑</text>
        <text>{{isVip ? '果园托管会员' : '普通用户'}}</text>
      </view>
    </view>
  </view>

  <view class="vip-card">
    <view class="card-bg-circle"></view>
    <view class="card-content">
      <view class="card-left">
        <block wx:if="{{!isVip}}">
          <text class="card-title">开通果园托管服务</text>
          <view class="redeem-box">
            <input class="code-input" 
                   placeholder="请输入激活码" 
                   placeholder-class="code-input-placeholder"
                   bindinput="onCodeInput" 
                   value="{{inputCode}}" />
          </view>
        </block>
        <block wx:else>
          <text class="card-title">👑 智能托管已开启</text>
          <text class="card-desc">服务生效中，享受实时预警</text>
        </block>
      </view>
      
      <view class="card-right">
        <button class="buy-btn" bindtap="submitRedeem" wx:if="{{!isVip}}">立即激活</button>
        <button class="buy-btn disabled" wx:else>使用中</button>
      </view>
    </view>
  </view>

  <view class="stats-row">
    <view class="stat-item">
      <text class="num">{{userStats.diagnosisCount || 0}}</text>
      <text class="label">累计诊断</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <text class="num">{{userStats.remainingPoints || 0}}</text>
      <text class="label">我的积分</text>
    </view>
  </view>

  <view class="menu-list">
    <view class="menu-item" bindtap="goOrchard">
      <view class="menu-left">
        <text class="menu-icon">🏡</text>
        <text class="menu-text">我的果园托管</text>
      </view>
      <text class="arrow">›</text>
    </view>

    <view class="menu-item" bindtap="goHistory">
      <view class="menu-left">
        <text class="menu-icon">📝</text>
        <text class="menu-text">诊断历史记录</text>
      </view>
      <text class="arrow">›</text>
    </view>

    <view class="menu-item" bindtap="goMyPrescription">
      <view class="menu-left">
        <text class="menu-icon">💊</text>
        <text class="menu-text">我的专属药方</text>
      </view>
      <text class="lock-icon" wx:if="{{!isVip}}">🔒</text>
      <text class="arrow" wx:else>›</text>
    </view>
    
    <button class="menu-item contact-btn" open-type="contact" style="width:100%;">
      <view class="menu-left">
        <text class="menu-icon">💬</text>
        <text class="menu-text">咨询农技专家</text>
      </view>
      <text class="arrow">›</text>
    </button>
  </view>
</view>