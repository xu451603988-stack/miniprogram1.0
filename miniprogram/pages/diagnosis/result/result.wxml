<view class="page-v4" wx:if="{{resultType === 'decision_tree_v5'}}">
  
  <view class="result-card {{report.severity}}">
    <view class="card-header">
      <text class="risk-badge">{{report.severityLabel}}</text>
      <text class="date">åˆšåˆš</text>
    </view>
    <view class="diagnosis-name">{{report.title}}</view>
    <view class="tags-row">
      <text wx:for="{{report.tags}}" wx:key="*this" class="tag">{{item}}</text>
    </view>
  </view>

  <view class="section-box">
    <view class="section-title">
      <text class="icon">ğŸ”</text> è¾¨è¯åˆ†æ
    </view>
    <view class="logic-content">
      <text user-select="true">{{report.logic}}</text>
    </view>
  </view>

  <view class="section-box">
    <view class="section-title">
      <text class="icon">ğŸ’Š</text> è°ƒç†æ–¹æ¡ˆ
    </view>
    <view class="solution-list">
      <block wx:for="{{report.solutions}}" wx:key="index">
        <view class="solution-item">
          <view class="sol-type">{{item.type}}</view>
          <view class="sol-text" user-select="true">{{item.content}}</view>
        </view>
      </block>
      <view wx:if="{{report.solutions.length === 0}}" class="empty-tip">
        <text>æš‚æ— ç‰¹å®šè¯ç‰©å»ºè®®ï¼Œè¯·å‚è€ƒç³»ç»Ÿè°ƒç†æ–¹æ¡ˆã€‚</text>
      </view>
    </view>
  </view>

  <view class="footer-btn-group">
    <button class="btn-primary" bindtap="retest">é‡æ–°è¯Šæ–­</button>
    <button class="btn-secondary" bindtap="goHome">è¿”å›é¦–é¡µ</button>
    <button class="btn-text" bindtap="contactDoctor">è”ç³»æ¤ä¿ä¸“å®¶</button>
  </view>

</view>

<view wx:else>
  <view class="page">
    <view class="summary-card">
      <view class="summary-top-row">
        <text class="summary-title">è¯Šæ–­ç»“æœ</text>
        <view wx:if="{{summaryStatusLabel}}" class="summary-pill pill-{{summaryStatusClass}}">
          <text class="summary-pill-text">{{summaryStatusLabel}}</text>
        </view>
      </view>
      <text class="summary-desc">{{summary || 'æš‚æ— è¯¦ç»†åˆ†æ'}}</text>
    </view>

    <scroll-view scroll-y="true" class="scroll-area">
      <block wx:if="{{isCombined}}">
        <view class="section-card" wx:if="{{leaf}}">
          <view class="section-title">{{leaf.title}}</view>
          <view class="section-body"><text class="main-text">{{leaf.reason}}</text></view>
        </view>
        <view class="section-card" wx:if="{{fruit}}">
          <view class="section-title">{{fruit.title}}</view>
          <view class="section-body"><text class="main-text">{{fruit.reason}}</text></view>
        </view>
        <view class="section-card" wx:if="{{root}}">
          <view class="section-title">{{root.title}}</view>
          <view class="section-body"><text class="main-text">{{root.reason}}</text></view>
        </view>
      </block>

      <view class="section-card" wx:elif="{{suggestions && suggestions.length > 0}}">
        <view class="section-title">å»ºè®®</view>
        <view class="section-body">
          <block wx:for="{{suggestions}}" wx:key="index">
            <view class="bullet-item">
              <view class="bullet-dot"></view>
              <text class="bullet-text">{{item}}</text>
            </view>
          </block>
        </view>
      </view>
    </scroll-view>

    <view class="footer-actions">
      <button class="btn-primary" bindtap="retest">é‡æ–°æµ‹è¯•</button>
      <button class="btn-secondary" bindtap="goHome">è¿”å›é¦–é¡µ</button>
    </view>
  </view>
</view>  