<view class="page-v4" wx:if="{{resultType === 'decision_tree_v5' || report}}">
  
  <view class="result-card {{report.severity}}">
    <view class="card-header">
      <view class="risk-tag">
        <text class="risk-icon">{{report.severity === 'mild' ? 'ğŸ›¡ï¸' : 'âš ï¸'}}</text>
        <text>{{report.severityLabel}}</text>
      </view>
      <text class="date">{{report.time}}</text>
    </view>
    
    <view class="diagnosis-name">{{report.title}}</view>
    
    <view class="tags-row" wx:if="{{report.tags && report.tags.length > 0}}">
      <text wx:for="{{report.tags}}" wx:key="*this" class="tag">{{item}}</text>
    </view>

    <view class="risk-bar-container">
      <view class="risk-bar-label">é£é™©æŒ‡æ•°</view>
      <view class="risk-track">
        <view class="risk-fill" 
              style="width: {{report.severity === 'severe' ? '90%' : (report.severity === 'moderate' ? '60%' : '30%')}}">
        </view>
      </view>
    </view>
  </view>

  <view class="section-box">
    <view class="section-title">
      <text class="icon">ğŸ”</text> ä¸“å®¶è¾¨è¯
    </view>
    <view class="logic-content">
      <text user-select="true">{{report.logic}}</text>
    </view>
  </view>

  <view class="section-box">
    <view class="section-title">
      <text class="icon">ğŸ’Š</text> è°ƒç†æ–¹æ¡ˆ
    </view>
    
    <view class="solution-list">
      <block wx:for="{{report.solutions}}" wx:key="index">
        <view class="solution-item" hover-class="item-hover">
          <view class="sol-type {{item.type === 'ç³»ç»Ÿå›ºæœ¬' ? 'root-type' : 'cure-type'}}">
            {{item.type || 'å»ºè®®'}}
          </view>
          <view class="sol-text" user-select="true">{{item.content}}</view>
        </view>
      </block>

      <view wx:if="{{!report.solutions || report.solutions.length === 0}}" class="empty-tip">
        <image class="empty-icon" src="/images/icon_leaf_gray.png" mode="aspectFit" wx:if="{{false}}"></image> <text>æš‚æ— ç‰¹å®šè¯ç‰©å»ºè®®ï¼Œè¯·å‚è€ƒç³»ç»Ÿè°ƒç†æ–¹æ¡ˆã€‚</text>
      </view>
    </view>
  </view>

  <view class="footer-btn-group">
    <button class="btn-secondary" hover-class="btn-hover" bindtap="goHome">è¿”å›é¦–é¡µ</button>
    <button class="btn-primary" hover-class="btn-hover" bindtap="retest">é‡æ–°è¯Šæ–­</button>
  </view>
 
  <button class="btn-text" hover-class="text-hover" bindtap="contactDoctor">è”ç³»æ¤ä¿ä¸“å®¶</button>

</view>

<view wx:else class="page-legacy">
  <view class="summary-card">
    <icon type="info" size="40" color="#999"></icon>
    <text class="legacy-text">æ•°æ®æ ¼å¼ä¸å…¼å®¹ï¼Œè¯·é‡æ–°æµ‹è¯•ã€‚</text>
  </view>
  <button class="btn-primary" bindtap="retest" style="margin-top:40rpx;">é‡æ–°æµ‹è¯•</button>
</view>