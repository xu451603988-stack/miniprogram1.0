<view class="container" wx:if="{{!loading}}">
  
  <view class="card diagnosis-card">
    <view class="card-header">
      <text class="label">ä¸­åŒ»è¾¨è¯ç»“æœ</text>
      <view class="confidence-tag">ç½®ä¿¡åº¦ {{report.confidence}}%</view>
    </view>
    
    <view class="syndrome-name">{{report.syndrome}}</view>
    
    <view class="constitution-tags">
      <text class="tag">{{report.constitution.desc}}</text>
    </view>

    <view class="divider"></view>

    <view class="section-title">ğŸ•µï¸â€â™‚ï¸ ç—…æœºæ¨æ¼”</view>
    <view class="logic-text">
      {{report.pathogenesis}}
    </view>
  </view>

  <view class="card evils-card">
    <view class="section-title">ğŸ“Š äº”é‚ªä¾µè¢­æŒ‡æ•°</view>
    <view class="evils-list">
      <block wx:for="{{evilsList}}" wx:key="key">
        <view class="evil-item" wx:if="{{item.score > 0}}">
          <view class="evil-label">{{item.label}}</view>
          <view class="progress-bg">
            <view class="progress-bar" style="width: {{item.percent}}%; background-color: {{item.color}}"></view>
          </view>
          <view class="evil-score">{{item.score}}</view>
        </view>
      </block>
      <view class="tips" wx:if="{{evilsList.length === 0 || evilsList[0].score === 0}}">
        ğŸŒ¿ å½“å‰ç¯å¢ƒæ°”åœºå¹³å’Œï¼Œæœªè§æ˜æ˜¾é‚ªæ°”ã€‚
      </view>
    </view>
  </view>

  <view class="card prescription-card">
    <view class="section-title">ğŸ’Š {{report.principleTitle || 'ç³»ç»Ÿè°ƒç†æ–¹æ¡ˆ'}}</view>
    
    <view class="steps-box">
      <block wx:for="{{report.prescription}}" wx:key="index">
        <view class="step-item">
          <view class="step-icon">{{item.icon || (index + 1)}}</view>
          <view class="step-content">
            <view class="step-method">{{item.name}}</view>
            <view class="step-action">{{item.desc}}</view>
          </view>
        </view>
      </block>
      
      <view class="tips" wx:if="{{!report.prescription || report.prescription.length === 0}}">
        æš‚æ— ç‰¹å®šæ“ä½œå»ºè®®ï¼Œå»ºè®®åŠ å¼ºç”°é—´ç®¡ç†ã€‚
      </view>
    </view>
  </view>

  <view class="footer-btns">
    <button class="btn-retry" bindtap="onRetry">é‡æ–°è¯Šæ–­</button>
    <button class="btn-home" bindtap="onGoHome">è¿”å›é¦–é¡µ</button>
  </view>

</view>

<view class="loading-box" wx:else>
  <view class="loading-spinner"></view>
  <text>ç³»ç»Ÿè¾¨è¯åˆ†æä¸­...</text>
</view>